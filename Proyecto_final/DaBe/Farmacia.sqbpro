<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="Farmacia.db" readonly="0" foreign_keys="1" case_sensitive_like="0" temp_store="0" wal_autocheckpoint="1000" synchronous="2"/><attached/><window><main_tabs open="structure browser pragmas query" current="1"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="100"/><column_width id="3" width="3288"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="3" parent="1"/></tab_structure><tab_browse><table title="Producto" custom_title="0" dock_id="1" table="4,8:mainProducto"/><dock_state state="000000ff00000000fd00000001000000020000039100000258fc0100000001fb000000160064006f0063006b00420072006f00770073006500310100000000000003910000012300ffffff000003910000000000000004000000040000000800000008fc00000000"/><default_encoding codec=""/><browse_table_settings><table schema="main" name="Categoria" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="82"/><column index="2" value="95"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Empleado" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="82"/><column index="2" value="127"/><column index="3" value="167"/><column index="4" value="71"/><column index="5" value="111"/><column index="6" value="55"/><column index="7" value="76"/><column index="8" value="71"/><column index="9" value="44"/><column index="10" value="98"/><column index="11" value="73"/><column index="12" value="39"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Presentacion" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="101"/><column index="2" value="78"/><column index="3" value="63"/><column index="4" value="79"/><column index="5" value="83"/><column index="6" value="40"/><column index="7" value="106"/><column index="8" value="91"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Producto" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="78"/><column index="2" value="95"/><column index="3" value="109"/><column index="4" value="73"/><column index="5" value="94"/><column index="6" value="83"/><column index="7" value="106"/><column index="8" value="91"/><column index="9" value="40"/><column index="10" value="83"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table></browse_table_settings></tab_browse><tab_sql><sql name="SQL 1">-- ===============================
-- CREACIÓN DE TABLAS
-- ===============================

-- Tabla de Empleados (con campo BLOB para foto)
CREATE TABLE IF NOT EXISTS Empleado (
  Id_Empleado     INTEGER PRIMARY KEY AUTOINCREMENT,
  Nombre          TEXT NOT NULL,
  Correo 		  TEXT NOT NULL UNIQUE,
  Telefono		  TEXT NOT NULL UNIQUE,
  Direccion       TEXT NOT NULL,
  Usuario         TEXT NOT NULL UNIQUE,
  Contrasenia     TEXT NOT NULL,
  Rol             TEXT NOT NULL CHECK (Rol IN ('GERENTE','VENDEDOR')),
  Activo          TEXT NOT NULL CHECK (Activo IN ('S','N')),
  Fecha_Contrato  TEXT NOT NULL,
  Fecha_Baja      TEXT,
  Foto            BLOB
);

-- Tabla de Categorías
CREATE TABLE IF NOT EXISTS Categoria (
  Id_Categoria    INTEGER PRIMARY KEY AUTOINCREMENT,
  Nombre          TEXT NOT NULL UNIQUE
);

-- Tabla de Productos (relación con Categoría)
CREATE TABLE IF NOT EXISTS Producto (
  Id_Producto      INTEGER PRIMARY KEY AUTOINCREMENT,
  Nombre           TEXT NOT NULL,
  Nombre_Generico  TEXT,
  Descripcion      TEXT,
  Precio_Compra    REAL NOT NULL CHECK (Precio_Compra &gt;= 0),
  Precio_Venta     REAL NOT NULL CHECK (Precio_Venta  &gt;= 0),
  Fecha_Caducidad  TEXT NOT NULL,
  Foto_Producto    BLOB,
  Stock            INTEGER NOT NULL CHECK (Stock &gt;= 0),
  Id_Categoria     INTEGER,
  FOREIGN KEY (Id_Categoria) REFERENCES Categoria(Id_Categoria)
);

-- Tabla de Ventas
CREATE TABLE IF NOT EXISTS Venta (
  Id_Venta     INTEGER PRIMARY KEY AUTOINCREMENT,
  Fecha        TEXT NOT NULL,
  Id_Empleado  INTEGER NOT NULL,
  FOREIGN KEY (Id_Empleado) REFERENCES Empleado(Id_Empleado)
);

-- Detalle de cada venta
CREATE TABLE IF NOT EXISTS Detalle_Venta (
  Id_Venta        INTEGER NOT NULL,
  Id_Producto     INTEGER NOT NULL,
  Cantidad        INTEGER NOT NULL CHECK (Cantidad &gt; 0),
  Precio_Unitario REAL NOT NULL CHECK (Precio_Unitario &gt;= 0),
  PRIMARY KEY (Id_Venta, Id_Producto),
  FOREIGN KEY (Id_Venta) REFERENCES Venta(Id_Venta),
  FOREIGN KEY (Id_Producto) REFERENCES Producto(Id_Producto)
);

-- Historial de contrataciones y despidos
CREATE TABLE IF NOT EXISTS Historial_Personal (
  Id_Hist        INTEGER PRIMARY KEY AUTOINCREMENT,
  Id_Empleado    INTEGER NOT NULL,
  Id_Gerente     INTEGER NOT NULL,
  Tipo_Evento    TEXT NOT NULL CHECK (Tipo_Evento IN ('CONTRATACION','DESPIDO')),
  Fecha_Evento   TEXT NOT NULL,
  Motivo         TEXT,
  FOREIGN KEY (Id_Empleado) REFERENCES Empleado(Id_Empleado),
  FOREIGN KEY (Id_Gerente) REFERENCES Empleado(Id_Empleado)
);

-- ===============================
-- INSERCIÓN DE DATOS INICIALES
-- ===============================

-- Categorías predefinidas
INSERT OR IGNORE INTO Categoria (Nombre) VALUES
('Pastillas'),
('Jarabes'),
('Inyecciones'),
('Píldoras'),
('Ungüentos');

-- Gerente predefinido (sin foto por ahora)
INSERT INTO Empleado (Nombre, Correo, Telefono, Direccion, Usuario, Contrasenia, Rol, Activo, Fecha_Contrato)
VALUES ('Gerente General', 'gerente123@gmail.com', '87848739', 'Barrio Lupita', 'admin', 'admin123', 'GERENTE', 'S', DATE('now'));

-- Vendedor de ejemplo (sin foto)
INSERT INTO Empleado (Nombre, Correo, Telefono, Direccion, Usuario, Contrasenia, Rol, Activo, Fecha_Contrato)
VALUES ('Carlos Espinoza', 'carlitos@gmail.com', '55007788', 'La Plazita', 'carlos', 'abcd', 'VENDEDOR', 'S', DATE('now'));

-- Algunos productos de ejemplo con categorías
INSERT INTO Producto (Nombre, Nombre_Generico, Precio_Compra, Precio_Venta, Fecha_Caducidad, Stock, Id_Categoria)
VALUES
('Paracetamol', 'Acetaminofén', 0.50, 1.00, '2026-12-31', 200, 1),  -- Pastillas
('Ibuprofeno', 'Ibuprofeno', 0.30, 0.80, '2025-11-30', 150, 1),     -- Pastillas
('Amoxicilina', 'Amoxicilina', 1.00, 2.50, '2027-01-15', 100, 3);  -- Inyecciones

SELECT Usuario, Contrasenia, Rol, Activo FROM Empleado;

ALTER TABLE Producto
ADD COLUMN Farmaceutica TEXT;

UPDATE Producto
SET Farmaceutica = 'Calox'
WHERE Nombre = 'Ibuprofeno';

UPDATE Producto
SET Farmaceutica = 'La Sante'
WHERE Nombre = 'Paracetamol';

UPDATE Producto
SET Farmaceutica = 'La Sante'
WHERE Nombre = 'Amoxicilina';

SELECT farmaceutica FROM Producto LIMIT 1;

ALTER TABLE Producto
ADD COLUMN Gramaje TEXT;

UPDATE Producto
SET Gramaje = '400 mg'
WHERE Nombre = 'Ibuprofeno';

UPDATE Producto
SET Gramaje = '750 mg'
WHERE Nombre = 'Paracetamol';

UPDATE Producto
SET Gramaje = '500 mg'
WHERE Nombre = 'Amoxicilina';



CREATE TABLE IF NOT EXISTS Presentacion (
    Id_Presentacion INTEGER PRIMARY KEY AUTOINCREMENT,
    Id_Producto INTEGER NOT NULL,       -- Relación con Producto
    Tipo TEXT NOT NULL,                 -- Ej: Tableta, Cápsula, Jarabe
    Gramaje TEXT NOT NULL,              -- Ej: 400mg, 120mg/5ml
    Precio_Venta REAL NOT NULL CHECK (Precio_Venta &gt;= 0),
    Stock INTEGER NOT NULL CHECK (Stock &gt;= 0),
    Fecha_Caducidad TEXT NOT NULL,
    Foto_Producto BLOB,
    FOREIGN KEY (Id_Producto) REFERENCES Producto(Id_Producto)
);

INSERT OR IGNORE INTO Categoria (Nombre) VALUES
('Analgesicos'),
('Antibioticos'),
('Antiinflamatorios');

INSERT INTO Presentacion (Id_Producto, Tipo, Gramaje, Precio_Venta, Stock, Fecha_Caducidad)
VALUES
(1, 'Tableta', '400mg', 0.80, 150, '2026-12-31'),
(1, 'Cápsula', '200mg', 0.50, 100, '2026-12-31'),
(2, 'Tableta', '750mg', 1.00, 200, '2026-12-31'),
(2, 'Jarabe', '120mg/5ml', 1.20, 80, '2025-11-30'),
(3, 'Cápsula', '500mg', 2.50, 100, '2027-01-15');

-- -------------------------------
-- INSERTAR 10 PRODUCTOS CON ACETAMINOFÉN
-- -------------------------------

-- Usar la categoría “Analgesicos” (asegúrate de que exista)
-- Suponemos que ya tienes “Analgesicos” en la tabla Categoria
-- Si no, puedes descomentar y ejecutar lo siguiente:
-- INSERT OR IGNORE INTO Categoria (Nombre) VALUES ('Analgesicos');

INSERT INTO Producto (Nombre, Nombre_Generico, Precio_Compra, Precio_Venta, Fecha_Caducidad, Stock, Id_Categoria)
VALUES
  ('Paracetamol Calox 500mg Tableta', 'Acetaminofén', 0.10, 0.25, '2027-12-31', 500, (SELECT Id_Categoria FROM Categoria WHERE Nombre = 'Analgesicos')),
  ('Paracetamol La Sante 750mg Tableta', 'Acetaminofén', 0.15, 0.40, '2028-06-30', 300, (SELECT Id_Categoria FROM Categoria WHERE Nombre = 'Analgesicos')),
  ('Tylenol Extra Strength 500mg', 'Acetaminofén', 0.20, 0.60, '2028-03-31', 200, (SELECT Id_Categoria FROM Categoria WHERE Nombre = 'Analgesicos')),
  ('Panadol Optizorb 500mg', 'Acetaminofén', 0.18, 0.55, '2027-09-30', 250, (SELECT Id_Categoria FROM Categoria WHERE Nombre = 'Analgesicos')),
  ('Acetaminofén Genérico 325mg Cápsula', 'Acetaminofén', 0.05, 0.15, '2029-01-31', 600, (SELECT Id_Categoria FROM Categoria WHERE Nombre = 'Analgesicos')),
  ('Acetaminofén Genérico 120mg/5ml Jarabe', 'Acetaminofén', 0.08, 0.20, '2026-11-30', 400, (SELECT Id_Categoria FROM Categoria WHERE Nombre = 'Analgesicos')),
  ('Panadol Night 500mg + Difenhidramina', 'Acetaminofén / Difenhidramina', 0.25, 0.70, '2027-08-31', 150, (SELECT Id_Categoria FROM Categoria WHERE Nombre = 'Analgesicos')),
  ('Paracetamol Calox 1000mg Tableta', 'Acetaminofén', 0.30, 0.80, '2028-12-31', 180, (SELECT Id_Categoria FROM Categoria WHERE Nombre = 'Analgesicos')),
  ('Paracetamol SantePlus 650mg Liberación Prolongada', 'Acetaminofén', 0.22, 0.65, '2029-05-31', 220, (SELECT Id_Categoria FROM Categoria WHERE Nombre = 'Analgesicos')),
  ('Acetaminofén Supositorio 150mg LaboratorioX', 'Acetaminofén', 0.12, 0.35, '2027-10-31', 100, (SELECT Id_Categoria FROM Categoria WHERE Nombre = 'Analgesicos'));

-- -------------------------------
-- INSERTAR PRESENTACIONES PARA ESOS PRODUCTOS
-- -------------------------------

INSERT INTO Presentacion (Id_Producto, Tipo, Gramaje, Precio_Venta, Stock, Fecha_Caducidad)
VALUES
  -- Paracetamol Calox 500mg Tableta
  ((SELECT Id_Producto FROM Producto WHERE Nombre = 'Paracetamol Calox 500mg Tableta'), 'Tableta', '500mg', 0.25, 500, '2027-12-31'),

  -- Paracetamol La Sante 750mg Tableta
  ((SELECT Id_Producto FROM Producto WHERE Nombre = 'Paracetamol La Sante 750mg Tableta'), 'Tableta', '750mg', 0.40, 300, '2028-06-30'),

  -- Tylenol Extra Strength 500mg
  ((SELECT Id_Producto FROM Producto WHERE Nombre = 'Tylenol Extra Strength 500mg'), 'Tableta', '500mg', 0.60, 200, '2028-03-31'),

  -- Panadol Optizorb 500mg
  ((SELECT Id_Producto FROM Producto WHERE Nombre = 'Panadol Optizorb 500mg'), 'Tableta', '500mg', 0.55, 250, '2027-09-30'),

  -- Acetaminofén Genérico 325mg Cápsula
  ((SELECT Id_Producto FROM Producto WHERE Nombre = 'Acetaminofén Genérico 325mg Cápsula'), 'Cápsula', '325mg', 0.15, 600, '2029-01-31'),

  -- Acetaminofén Genérico 120mg/5ml Jarabe
  ((SELECT Id_Producto FROM Producto WHERE Nombre = 'Acetaminofén Genérico 120mg/5ml Jarabe'), 'Jarabe', '120mg/5ml', 0.20, 400, '2026-11-30'),

  -- Panadol Night 500mg + Difenhidramina
  ((SELECT Id_Producto FROM Producto WHERE Nombre = 'Panadol Night 500mg + Difenhidramina'), 'Tableta', '500mg + Difenhidramina', 0.70, 150, '2027-08-31'),

  -- Paracetamol Calox 1000mg Tableta
  ((SELECT Id_Producto FROM Producto WHERE Nombre = 'Paracetamol Calox 1000mg Tableta'), 'Tableta', '1000mg', 0.80, 180, '2028-12-31'),

  -- Paracetamol SantePlus 650mg Liberación Prolongada
  ((SELECT Id_Producto FROM Producto WHERE Nombre = 'Paracetamol SantePlus 650mg Liberación Prolongada'), 'Tableta', '650mg (lib prolongada)', 0.65, 220, '2029-05-31'),

  -- Acetaminofén Supositorio 150mg LaboratorioX
  ((SELECT Id_Producto FROM Producto WHERE Nombre = 'Acetaminofén Supositorio 150mg LaboratorioX'), 'Supositorio', '150mg', 0.35, 100, '2027-10-31');

-- Nuevo empleado ejemplo (Vendedor)
INSERT INTO Empleado (
    Nombre, Correo, Telefono, Direccion, Usuario, Contrasenia, Rol, Activo, Fecha_Contrato, Fecha_Baja, Foto
) VALUES (
    'María López',                -- Nombre
    'maria.lopez@gmail.com',      -- Correo
    '55009988',                   -- Teléfono
    'Colonia Centro',             -- Dirección
    'mlopez',                     -- Usuario
    'mypass123',                  -- Contraseña
    'VENDEDOR',                   -- Rol
    'S',                          -- Activo (S/N)
    DATE('now'),                  -- Fecha de contrato
    NULL,                         -- Fecha de baja (NULL porque está activa)
    NULL                          -- Foto (BLOB, NULL por ahora)
);

-- Empleado 2 (Vendedor)
INSERT INTO Empleado (
    Nombre, Correo, Telefono, Direccion, Usuario, Contrasenia, Rol, Activo, Fecha_Contrato, Fecha_Baja, Foto
) VALUES (
    'Luis Fernández',              -- Nombre
    'luis.fernandez@gmail.com',    -- Correo
    '55001122',                    -- Teléfono
    'Barrio San Juan',             -- Dirección
    'lfernandez',                  -- Usuario
    'luis1234',                    -- Contraseña
    'VENDEDOR',                     -- Rol
    'S',                            -- Activo
    DATE('now'),                    -- Fecha de contrato
    NULL,                           -- Fecha de baja
    NULL                            -- Foto
);

-- Empleado 3 (Gerente)
INSERT INTO Empleado (
    Nombre, Correo, Telefono, Direccion, Usuario, Contrasenia, Rol, Activo, Fecha_Contrato, Fecha_Baja, Foto
) VALUES (
    'Ana Morales',                 -- Nombre
    'ana.morales@gmail.com',       -- Correo
    '55003344',                    -- Teléfono
    'Colonia Los Pinos',           -- Dirección
    'amorales',                    -- Usuario
    'ana2025',                     -- Contraseña
    'VENDEDOR',                     -- Rol
    'S',                            -- Activo
    DATE('now'),                    -- Fecha de contrato
    NULL,                           -- Fecha de baja
    NULL                            -- Foto
);

ALTER TABLE Producto
ADD COLUMN Activo TEXT NOT NULL DEFAULT 'S' 
CHECK (Activo IN ('S','N'));

ALTER TABLE Empleado
ADD COLUMN Identificacion TEXT;








</sql><current_tab id="0"/></tab_sql></sqlb_project>
